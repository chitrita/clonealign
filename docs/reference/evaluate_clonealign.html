<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Evaluate the quality of a clonealign fit — evaluate_clonealign • clonealign</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Evaluate the quality of a clonealign fit — evaluate_clonealign" />

<meta property="og:description" content="Use mean squared error of predicting the expression of held-out genes to evaluate the quality of a clonealign fit." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">clonealign</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction_to_clonealign.html">Introduction to clonealign</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluate the quality of a clonealign fit</h1>
    
    <div class="hidden name"><code>evaluate_clonealign.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Use mean squared error of predicting the expression of held-out genes to evaluate the quality of a clonealign fit.</p>
    
    </div>

    <pre class="usage"><span class='fu'>evaluate_clonealign</span>(<span class='no'>gene_expression_data</span>, <span class='no'>copy_number_data</span>, <span class='no'>clonealign_fit</span>,
  <span class='kw'>prop_holdout</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>n_samples</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>s</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gene_expression_data</th>
      <td><p>Either a <code>SingleCellExperiment</code> or matrix of counts, same as input to <code>clonealign</code></p></td>
    </tr>
    <tr>
      <th>copy_number_data</th>
      <td><p>A gene-by-clone matrix of copy numbers, the same as the input to <code>clonealign</code></p></td>
    </tr>
    <tr>
      <th>clonealign_fit</th>
      <td><p>The fit returned by a call to <code><a href='clonealign.html'>clonealign()</a></code> on the full geneset</p></td>
    </tr>
    <tr>
      <th>prop_holdout</th>
      <td><p>The proportion of genes to hold out as a <em>test</em> set for predicting gene expression</p></td>
    </tr>
    <tr>
      <th>n_samples</th>
      <td><p>The number of random permutations to establish a null distribution of predictive performance</p></td>
    </tr>
    <tr>
      <th>s</th>
      <td><p>Vector of cell size factors - defaults to the total counts per cell</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to pass to the <code>clonealign</code> call</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list object describing the evaluation results. See <code>details</code></p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This evaluation function is built around the idea of how good predicted expression is under the model given
the inferred (assigned) clones compared to how well you could predict expression given a random clonal assignment.</p>
<p><strong>Evaluations performed</strong></p>
<ol>
<li><p>On the <em>full</em> dataset, the mean square error is compared to the randomized error, and a message
printed about the ratio of the two errors and the proportion of time the observed error was less than the
error under a null distribution. If either the error under the null is smaller than the observed, or is
smaller some percentage of time, then the fit has real problems and should be abandoned as it suggests the
model is stuck in a local maxima (which could happen if the proposed clones aren't actually present in the
RNA-seq).</p></li>
<li><p>A certain proportion of genes (as decided by the <code>prop_holdout</code> parameter) are held out as a <em>test</em>
set, and the clonealign fit is re-performed on the <code>1 - prop_holdout</code> proportion of genes. The function will then
print an agreement table of clone assignments between the full table and the reduced table. If these vastly disagree
for only a small change in gene set (ie <code>prop_holdout</code> is around 0.1 or 0.2), then the fit may be unreliable
as it is sensitive to the genes inputted.</p></li>
<li><p>The same metrics from (1) are then printed where the evaluations are performed on the heldout set. Again,
if the observed mean squared error given the clonealign fit isn't less than the null mean squared error
a large proportion of the time, the fit may be unreliable.</p></li>
</ol>
    <p><strong>Object returned</strong></p>
<p>Everything computed above is returned in a list object with the following entries:</p>
<ul>
<li><p>full_clonealign_fit - the original clonealign fit on the full gene set that was passed in as the
<code>clonealign_fit</code> argument</p></li>
<li><p>full_observed_mse - the observed mean square error using the full gene set</p></li>
<li><p>full_null_mse - A vector of mean square error under the randomized (permuted) distribution</p></li>
<li><p>reduced_clonealign_fit - a clonealign fit on only the reduced (train) set of genes</p></li>
<li><p>heldout_inds - the indices of the genes held out (test set) for evaluating predictive performance
out-of-sample</p></li>
<li><p>kept_inds - the indices of retained genes as part of the reduced (train) set</p></li>
<li><p>heldout_observed_mse - the observed mean square error on the heldout (test) set of genes</p></li>
<li><p>heldout_null_mse - a vector of mean square errors under a null distribution of randomly permuting the clones</p></li>
</ul>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>SingleCellExperiment</span>)
<span class='fu'>data</span>(<span class='no'>example_clonealign_fit</span>)
<span class='fu'>data</span>(<span class='no'>example_sce</span>)
<span class='no'>copy_number_data</span> <span class='kw'>&lt;-</span> <span class='fu'>rowData</span>(<span class='no'>example_sce</span>)[,<span class='fu'>c</span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>)]
<span class='fu'>evaluate_clonealign</span>(<span class='no'>example_sce</span>, <span class='no'>copy_number_data</span>, <span class='no'>example_clonealign_fit</span>)</div><div class='output co'>#&gt; On the full dataset, the observed MSE was on average 1.00068199101321 times smaller than under a null model and smaller 100% of the time</div><div class='output co'>#&gt; <span class='message'>Fitting reduced clonealign model...</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [&gt;--------------------------------]   2% | change in elbo 0.0096%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [&gt;--------------------------------]   3% | change in elbo 0.0070%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [&gt;--------------------------------]   4% | change in elbo 0.0053%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=&gt;-------------------------------]   5% | change in elbo 0.0015%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=&gt;-------------------------------]   6% | change in elbo 0.0039%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=&gt;-------------------------------]   7% | change in elbo 0.0033%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==&gt;------------------------------]   8% | change in elbo 0.0032%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==&gt;------------------------------]   9% | change in elbo 0.0022%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==&gt;------------------------------]  10% | change in elbo 0.0015%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===&gt;-----------------------------]  11% | change in elbo 0.0023%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===&gt;-----------------------------]  12% | change in elbo 0.0015%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===&gt;-----------------------------]  13% | change in elbo 0.0017%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [====&gt;----------------------------]  14% | change in elbo 0.0014%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [====&gt;---------------------------]  15% | change in elbo 0.00092%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [====&gt;----------------------------]  16% | change in elbo 0.0019%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=====&gt;---------------------------]  17% | change in elbo 0.0014%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=====&gt;---------------------------]  18% | change in elbo 0.0015%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=====&gt;------------------------]  19% | change in elbo -0.000064%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [======&gt;--------------------------]  20% | change in elbo 0.0019%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [======&gt;--------------------------]  21% | change in elbo 0.0016%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [======&gt;-------------------------]  22% | change in elbo 0.00080%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=======&gt;-------------------------]  23% | change in elbo 0.0015%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=======&gt;------------------------]  24% | change in elbo 0.00050%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=======&gt;------------------------]  25% | change in elbo 0.00018%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=======&gt;-----------------------]  26% | change in elbo -0.00022%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [========&gt;------------------------]  27% | change in elbo 0.0023%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [========&gt;-----------------------]  28% | change in elbo 0.00071%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [========&gt;------------------------]  29% | change in elbo 0.0011%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [========&gt;----------------------]  30% | change in elbo -0.00064%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=========&gt;-----------------------]  31% | change in elbo 0.0011%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=========&gt;----------------------]  32% | change in elbo 0.00023%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=========&gt;----------------------]  33% | change in elbo 0.00093%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=========&gt;---------------------]  34% | change in elbo -0.00051%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==========&gt;----------------------]  35% | change in elbo 0.0016%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==========&gt;--------------------]  36% | change in elbo -0.00023%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===========&gt;---------------------]  37% | change in elbo 0.0010%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===========&gt;-------------------]  38% | change in elbo -0.00081%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [============&gt;--------------------]  39% | change in elbo 0.0023%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===========&gt;-------------------]  40% | change in elbo 0.000047%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [============&gt;------------------]  41% | change in elbo -0.00077%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [============&gt;-------------------]  42% | change in elbo 0.00096%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [============&gt;------------------]  43% | change in elbo -0.00097%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=============&gt;------------------]  44% | change in elbo 0.00014%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=============&gt;------------------]  45% | change in elbo 0.00090%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==============&gt;-----------------]  46% | change in elbo 0.00092%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==============&gt;------------------]  47% | change in elbo 0.0011%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==============&gt;-----------------]  48% | change in elbo -0.0013%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===============&gt;----------------]  49% | change in elbo -0.0011%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===============&gt;-----------------]  50% | change in elbo 0.0029%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===============&gt;----------------]  50% | change in elbo 0.00034%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===============&gt;---------------]  51% | change in elbo -0.00052%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===============&gt;--------------]  52% | change in elbo -0.000024%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [================&gt;---------------]  53% | change in elbo 0.00064%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [================&gt;--------------]  54% | change in elbo -0.00053%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [================&gt;--------------]  55% | change in elbo -0.00031%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=================&gt;--------------]  56% | change in elbo 0.00091%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=================&gt;--------------]  57% | change in elbo -0.0010%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==================&gt;--------------]  58% | change in elbo 0.0013%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=================&gt;-------------]  59% | change in elbo -0.00097%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===================&gt;-------------]  60% | change in elbo 0.0011%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==================&gt;------------]  61% | change in elbo -0.00020%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===================&gt;------------]  62% | change in elbo 0.00016%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===================&gt;------------]  63% | change in elbo -0.0021%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [====================&gt;------------]  64% | change in elbo 0.0021%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===================&gt;-----------]  65% | change in elbo -0.00032%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [====================&gt;----------]  66% | change in elbo 0.000086%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=====================&gt;-----------]  67% | change in elbo 0.0017%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=====================&gt;----------]  68% | change in elbo -0.0026%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [======================&gt;----------]  69% | change in elbo 0.0016%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=====================&gt;----------]  70% | change in elbo 0.00090%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=====================&gt;---------]  71% | change in elbo -0.00016%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=====================&gt;---------]  72% | change in elbo -0.00028%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [======================&gt;--------]  73% | change in elbo 0.000047%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [======================&gt;--------]  74% | change in elbo -0.00094%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=======================&gt;--------]  75% | change in elbo 0.00023%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=======================&gt;--------]  76% | change in elbo 0.00030%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=======================&gt;-------]  77% | change in elbo 0.000049%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [========================&gt;-------]  78% | change in elbo 0.00029%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [========================&gt;------]  79% | change in elbo -0.00082%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=========================&gt;-------]  80% | change in elbo 0.0011%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [========================&gt;------]  81% | change in elbo -0.00047%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=========================&gt;------]  82% | change in elbo 0.00067%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=========================&gt;-----]  83% | change in elbo -0.00077%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==========================&gt;-----]  84% | change in elbo 0.00048%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==========================&gt;-----]  85% | change in elbo 0.00032%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=========================&gt;----]  86% | change in elbo -0.000031%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==========================&gt;----]  87% | change in elbo -0.00091%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===========================&gt;----]  88% | change in elbo 0.00083%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===========================&gt;---]  89% | change in elbo -0.00097%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [============================&gt;---]  90% | change in elbo 0.00092%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===========================&gt;---]  91% | change in elbo -0.00020%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [============================&gt;---]  92% | change in elbo 0.00064%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [============================&gt;--]  93% | change in elbo -0.00035%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [=============================&gt;--]  94% | change in elbo 0.00016%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [============================&gt;--]  95% | change in elbo -0.00029%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [============================&gt;-]  96% | change in elbo -0.000041%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [==============================&gt;-]  97% | change in elbo 0.00025%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [============================&gt;-]  98% | change in elbo -0.000051%</span></div><div class='output co'>#&gt; <span class='message'></span></div><div class='output co'>#&gt; <span class='message'>  running VB [===============================&gt;]  99% | change in elbo 0.00031%</span></div><div class='output co'>#&gt; Agreement between original (rows) and reduced (columns):   
#&gt;       A   B   C
#&gt;   A  51  33   1
#&gt;   B   2 100   9
#&gt;   C   0   0   4
#&gt; On the held-out dataset, the observed MSE was on average 1.00104532277777 times smaller than under a null model and smaller 100% of the time</div><div class='output co'>#&gt; $full_clonealign_fit
#&gt; A clonealign_fit for 200 cells, 100 genes, and 3 clones
#&gt; To access clone assignments, call x$clone
#&gt; To access ML parameter estimates, call x$ml_params
#&gt; $full_observed_mse
#&gt; [1] 8.165564
#&gt; 
#&gt; $full_null_mse
#&gt;   [1] 8.154310 8.166977 8.188727 8.181782 8.165159 8.167555 8.179075 8.172130
#&gt;   [9] 8.184131 8.165554 8.187043 8.180571 8.176795 8.171300 8.157375 8.175110
#&gt;  [17] 8.185641 8.179719 8.171748 8.192153 8.161636 8.155985 8.154671 8.171442
#&gt;  [25] 8.187066 8.178323 8.170458 8.165517 8.172348 8.159575 8.174497 8.168530
#&gt;  [33] 8.179797 8.163616 8.189642 8.171136 8.169682 8.176496 8.160318 8.173017
#&gt;  [41] 8.173295 8.167151 8.179799 8.173885 8.180725 8.175595 8.177047 8.152684
#&gt;  [49] 8.173981 8.186816 8.157725 8.179524 8.165856 8.165767 8.164624 8.183834
#&gt;  [57] 8.177253 8.178063 8.149822 8.152051 8.171897 8.156803 8.181463 8.168415
#&gt;  [65] 8.163356 8.159418 8.174528 8.180864 8.169265 8.176029 8.195466 8.176538
#&gt;  [73] 8.166471 8.180492 8.168597 8.170262 8.180743 8.175697 8.173597 8.178742
#&gt;  [81] 8.164570 8.168137 8.175971 8.174829 8.157045 8.174294 8.169496 8.156630
#&gt;  [89] 8.165271 8.164037 8.170882 8.158499 8.175376 8.164344 8.169433 8.157970
#&gt;  [97] 8.160361 8.165938 8.167727 8.161714
#&gt; 
#&gt; $reduced_clonealign_fit
#&gt; A clonealign_fit for 200 cells, 80 genes, and 3 clones
#&gt; To access clone assignments, call x$clone
#&gt; To access ML parameter estimates, call x$ml_params
#&gt; $heldout_inds
#&gt;  [1] 72 66 60 90  3 22 52 80 17  9 87  1 81 37 20 59 98 34 67 45
#&gt; 
#&gt; $kept_inds
#&gt;  [1]   2   4   5   6   7   8  10  11  12  13  14  15  16  18  19  21  23  24  25
#&gt; [20]  26  27  28  29  30  31  32  33  35  36  38  39  40  41  42  43  44  46  47
#&gt; [39]  48  49  50  51  53  54  55  56  57  58  61  62  63  64  65  68  69  70  71
#&gt; [58]  73  74  75  76  77  78  79  82  83  84  85  86  88  89  91  92  93  94  95
#&gt; [77]  96  97  99 100
#&gt; 
#&gt; $heldout_observed_mse
#&gt; [1] 5.060314
#&gt; 
#&gt; $heldout_null_mse
#&gt;   [1] 5.047976 5.079231 5.045589 5.072601 5.038944 5.068903 5.059268 5.018302
#&gt;   [9] 5.076334 5.085652 5.092805 5.054970 5.073584 5.085130 5.032874 5.030923
#&gt;  [17] 5.062821 5.058825 5.065252 5.069371 5.092889 5.066601 5.079692 5.064945
#&gt;  [25] 5.080774 5.075409 5.022453 5.050223 5.058505 5.083837 5.073288 5.063863
#&gt;  [33] 5.040052 5.089590 5.068245 5.045626 5.078114 5.020177 5.114059 5.075857
#&gt;  [41] 5.048223 5.061796 5.047791 5.048481 5.070281 5.045415 5.083511 5.088473
#&gt;  [49] 5.113912 5.052013 5.078123 5.051769 5.082680 5.061381 5.085314 5.071214
#&gt;  [57] 5.101640 5.079185 5.039494 5.071479 5.044071 5.095103 5.073446 5.049466
#&gt;  [65] 5.100744 5.066650 5.063223 5.062352 5.067454 5.039386 5.057637 5.065010
#&gt;  [73] 5.052644 5.049152 5.047871 5.072357 5.062026 5.054460 5.073883 5.060295
#&gt;  [81] 5.047926 5.087664 5.051152 5.066241 5.077961 5.068980 5.076766 5.074270
#&gt;  [89] 5.070654 5.079098 5.041946 5.083532 5.048877 5.100982 5.036633 5.074286
#&gt;  [97] 5.050818 5.078271 5.076683 5.064705
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kieran Campbell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

